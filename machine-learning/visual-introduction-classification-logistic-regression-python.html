<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-97459416-1"> 
  </script>

  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-97459416-1');
  </script>

  <meta name="author" content="Dan Friedman">
  <meta name="geo.region" content="CA">
  <meta property="og:locale" content="en_us">
  <meta name="robot" content="all">
  <meta name="referrer" content="always">
  <meta property="fb:profile_id" content="1357771151">
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Dan Friedman's Data Science Knowledge Base">

  <meta property="og:see_also" content="https://twitter.com/_DanFriedman"/>
  <meta property="og:see_also" content="https://www.linkedin.com/in/danfriedman33/"/>
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@_DanFriedman">
  <meta name="twitter:image" content="https://pbs.twimg.com/profile_images/950134514113691648/7dt7ECh2_400x400.jpg" />

  <meta name="keywords" content="visual introduction classification python">

  <meta name="description" content="A visual introduction to a classification problem setup and using Logistic Regression in Python">
  <meta property="og:description"  content="A visual introduction to a classification problem setup and using Logistic Regression in Python">
  <meta name="twitter:description" content="A visual introduction to a classification problem setup and using Logistic Regression in Python">

  <meta property="og:title" content="Visual Introduction to Classification and Logistic Regression">
  <meta name="twitter:title" content="Visual Introduction to Classification and Logistic Regression">

  <link rel="canonical" href="https://dfrieds.com/machine-learning/visual-introduction-classification-logistic-regression-python"/>

  <title>Visual Introduction to Classification and Logistic Regression - Machine Learning</title>

  

  <!-- Latest compiled and minified Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link rel="stylesheet" href="https://dfrieds.com/theme/css/ie10-viewport-bug-workaround.css" />
  
  <!-- Custom styles for this template -->
  <link rel="stylesheet" href="https://dfrieds.com/theme/css/style.css" />

  <!--don't need this for live-->
  <!-- <link rel="stylesheet" href="theme/css/style.css"/> -->

  <link rel="stylesheet" href="https://dfrieds.com/theme/css/notebooks.css" />
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800,900" rel="stylesheet">


  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <link href="https://dfrieds.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Dan Friedman's Data Science Knowledge Base Full Atom Feed" />    <link href="https://dfrieds.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Dan Friedman's Data Science Knowledge Base Full RSS Feed" />      <link href="https://dfrieds.com/feeds/machine-learning.atom.xml" type="application/atom+xml" rel="alternate" title="Dan Friedman's Data Science Knowledge Base Categories Atom Feed" />    <link href="https://dfrieds.com/feeds/machine-learning.rss.xml" type="application/rss+xml" rel="alternate" title="Dan Friedman's Data Science Knowledge Base Categories RSS Feed" />    

  <!-- Start of Async Drift Code -->
  <script>
    !function() {
      var t;
      if (t = window.driftt = window.drift = window.driftt || [], !t.init) return t.invoked ? void (window.console && console.error && console.error("Drift snippet included twice.")) : (t.invoked = !0, 
        t.methods = [ "identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on" ], 
        t.factory = function(e) {
          return function() {
            var n;
            return n = Array.prototype.slice.call(arguments), n.unshift(e), t.push(n), t;
          };
        }, t.methods.forEach(function(e) {
          t[e] = t.factory(e);
        }), t.load = function(t) {
          var e, n, o, i;
          e = 3e5, i = Math.ceil(new Date() / e) * e, o = document.createElement("script"), 
          o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + i + "/" + t + ".js", 
          n = document.getElementsByTagName("script")[0], n.parentNode.insertBefore(o, n);
        });
      }();
    drift.SNIPPET_VERSION = '0.3.1';
    drift.load('83xk3ceba36c');
  </script>
  <!-- End of Async Drift Code -->


</head>

<body>
  <div class="machine-learning"></div>

  <nav class="navbar navbar-expand-sm fixed-top">
    <div class="container">
      <a class="navbar-brand" href="https://dfrieds.com/">Dan<span class="green">_</span>Friedman</a>
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggle-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="nav navbar-nav mr-auto">
        </ul>
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tutorials</a>
              
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="https://dfrieds.com/#math">Math</a>
                <a class="dropdown-item" href="https://dfrieds.com/#data-analysis">Data Analysis with pandas</a>
                <a class="dropdown-item" href="https://dfrieds.com/#dataviz">Data Visualizations</a>
                <a class="dropdown-item" href="https://dfrieds.com/#python">Python</a>
                <a class="dropdown-item" href="https://dfrieds.com/#ml">Machine Learning</a>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://dfrieds.com/#articles">Articles</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://dfrieds.com/about">About</a>
            </li>
          </ul>
      </div>
    </div>
  </nav>


  <!-- end of header section -->
  <div class="container">

<section id="content" class="body">
  <header>
    <div class="posttype"> Machine Learning Classification Tutorial</div>
    <h1 class="articleh1">
      Visual Introduction to Classification and Logistic Regression
    </h1>

    <ul class ="row article_info">
      
      <li>
        Dec 25&nbsp;&nbsp;&bull;&nbsp;&nbsp;43 min read
      </li>
      <li class="tagarticle">
        Key Terms:         classification,
        logistic regression,
        math
      </li>
    </ul>
  </header>

  <div class='article_content'>
    <p>The tutorial is a high-level overview of classification problems in machine learning and how Logistic Regression works with a single feature and a binary target. </p>
<p>I'll cover the following topics:</p>
<ul>
<li>Overview of Classification &amp; Key Terms</li>
<li>Most Popular Classification Algorithms</li>
<li>Examples of Classification in Industry</li>
<li>Walkthrough of Credit Card Application Visualizations</li>
<li>Logistic Regression</li>
<li>Evaluation Metrics<ul>
<li>Accuracy</li>
<li>Precision &amp; Recall</li>
</ul>
</li>
</ul>
<h4>Import Modules</h4>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">recall_score</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="kn">as</span> <span class="nn">tick</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="kn">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span> <span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>


<h4>Visualization Setup</h4>
<div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;grid.color&#39;</span><span class="p">:</span> <span class="s1">&#39;.92&#39;</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">reformat_large_tick_values</span><span class="p">(</span><span class="n">tick_val</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns large tick values (in the billions, millions and thousands) such as 4500 into 4.5K and also appropriately turns 4000 into 4K (no zero after the decimal).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tick_val</span> <span class="o">&gt;=</span> <span class="mi">1000000000</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">tick_val</span><span class="o">/</span><span class="mi">1000000000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">new_tick_format</span> <span class="o">=</span> <span class="s1">&#39;{:}B&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tick_val</span> <span class="o">&gt;=</span> <span class="mi">1000000</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">tick_val</span><span class="o">/</span><span class="mi">1000000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">new_tick_format</span> <span class="o">=</span> <span class="s1">&#39;{:}M&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tick_val</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">tick_val</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">new_tick_format</span> <span class="o">=</span> <span class="s1">&#39;{:}K&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tick_val</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">new_tick_format</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">tick_val</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_tick_format</span> <span class="o">=</span> <span class="n">tick_val</span>

    <span class="c1"># make new_tick_format into a string value</span>
    <span class="n">new_tick_format</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_tick_format</span><span class="p">)</span>

    <span class="c1"># code below will keep 4.5M as is but change values such as 4.0M to 4M since that zero after the decimal isn&#39;t needed</span>
    <span class="n">index_of_decimal</span> <span class="o">=</span> <span class="n">new_tick_format</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">index_of_decimal</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">value_after_decimal</span> <span class="o">=</span> <span class="n">new_tick_format</span><span class="p">[</span><span class="n">index_of_decimal</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value_after_decimal</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="c1"># remove the 0 after the decimal point since it&#39;s not needed</span>
            <span class="n">new_tick_format</span> <span class="o">=</span> <span class="n">new_tick_format</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">index_of_decimal</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_tick_format</span><span class="p">[</span><span class="n">index_of_decimal</span><span class="o">+</span><span class="mi">2</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">new_tick_format</span>
</pre></div>


<h3>Overview of Classification &amp; Key Terms</h3>
<h4>Problem Setup</h4>
<p>Classification involves building a best fit equation to predict the probability an observation is of a certain class/label. Let's break down what some of those terms mean. </p>
<p>In order to use a classification algorithm, you must be provided with observations, features and labeled data. Let's say we work for a bank and it's our job to approve or deny credit card applicants.</p>
<h4>Example: Credit Card Application</h4>
<p>Most Americans age 18+ likely have a debit or credit card. Credit cards are issued by banks and businesses, allowing the holder to purchase goods or services on credit. Essentially, you can buy items without the exact cash on hand - but in agreement to pay back the bank later. You can learn more about applying for credit cards on <a href='https://www.nerdwallet.com/blog/credit-cards/apply-for-a-credit-card/' rel="nofollow"> Nerdwallet</a>.</p>
<p>To obtain a credit card, you must apply for one through a bank. A bank will decide/classify if you are worthy of the card. </p>
<p>Below is some fake sample data that indicates important features considered before one is able to be approved for a credit card.</p>
<p><em>Credit score</em>, <em>debt</em>, <em>yearly income</em>, and <em>age</em> are all features. The field for the classification label is <em>credit card decision</em>.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Credit Score</th>
<th>Debt (\$)</th>
<th>Yearly Income (\$)</th>
<th>Age</th>
<th>Credit Card Decision</th>
</tr>
</thead>
<tbody>
<tr>
<td>Joe Smith</td>
<td>610</td>
<td>3000</td>
<td>45000</td>
<td>24</td>
<td>Denied</td>
</tr>
<tr>
<td>Jill Mason</td>
<td>620</td>
<td>12000</td>
<td>58000</td>
<td>22</td>
<td>Approved</td>
</tr>
<tr>
<td>Brandon Cohen</td>
<td>700</td>
<td>0</td>
<td>90000</td>
<td>27</td>
<td>Approved</td>
</tr>
<tr>
<td>Ariel Pan</td>
<td>720</td>
<td>0</td>
<td>110000</td>
<td>29</td>
<td>Approved</td>
</tr>
</tbody>
</table>
<p>There's a small trend that people that have a higher credit score, less debt and more income are more likely to be approved for a particular credit card.</p>
<p>In the table above, each row is considered an <strong>observation</strong>. With each observation as a record of a person, there's additional details on their credit score, debt, yearly income and age.</p>
<p>The columns <em>Credit Score</em> and <em>Debt (\<span class="math">\()*, *Yearly Income (\\)</span>)</em> and <em>Age</em> are considered <strong>features</strong>. They are measurable characteristics for each observation. </p>
<p>The last column in our table is <em>Credit Card Decision</em> and represents a <strong>class</strong> or sometimes considered a label. In the past, a representative from the bank would choose to approve or deny each credit card application based on that observation's features. A popular name for this scenario is called <a href='https://en.wikipedia.org/wiki/Labeled_data' rel='nofollow'><strong>labeled data</strong></a>.</p>
<h4>Binary Classification</h4>
<p>In the example above, there were just two possible class labels - either <em>Denied</em> or <em>Approved</em>. Therefore, this is considered a <a href='https://en.wikipedia.org/wiki/Binary_classification' rel='nofollow'>binary classification</a> example. The term <em>binary</em> means related to two things.</p>
<h4>Multiclass Classification</h4>
<p>In machine learning, a <a href='https://en.wikipedia.org/wiki/Multiclass_classification' rel='nofollow'><strong>multiclass classifier</strong></a> is the problem of classifying observations into <em>three</em> or more classes. </p>
<h3>Most Popular Classification Algorithms</h3>
<p>These five below I consider <em>classical</em> machine learning algorithms -  as many were first profiled tens of years ago.</p>
<ul>
<li>Logistic Regression</li>
<li>SVM</li>
<li>Naive Bayes</li>
<li>Decision Trees</li>
<li>Random Forest</li>
</ul>
<p>In this notebook, we're just going to learn Logistic Regression. Why? Well Logistic Regression is simple to implement and fits to data quickly. Also, this model is very interpretable -  both in the math with how it works and interpretability of features. Not all other algorithms listed above also fit this criteria.</p>
<p>However, note Logistic Regression is often regarded as one of the simpler classification algorithms. It is just OK at capturing the variance with many features. So, you likely won't get as strong of a fit of a model with it compared to more complex machine learning models like XGBoost or neural networks.</p>
<p>Let's next talk about some additional business scenarios in which classification is commonly used in industry.</p>
<h3>Popular Examples of Classification Models in Industry</h3>
<ul>
<li>Diagnosed with a certain type of disease</li>
<li>Spam classification of text comments</li>
<li>Image classification<ul>
<li>Hot dog or not hot dog</li>
<li>Nudity or not nudity</li>
<li>Food safe to eat or not</li>
<li>recognize objects on streets for self-driving cars</li>
</ul>
</li>
<li>Customer churn - essentially will a person continue using an app/service or leave</li>
<li>Default or not on a credit card</li>
</ul>
<h3>Visual Derivation of Logistic Regression Equation</h3>
<p>Let's continue with our credit card application example. We'll utilize a single feature, <em>yearly income</em>, and two class labels of <em>approved</em> and <em>denied</em>.</p>
<div class="highlight"><pre><span></span><span class="n">yearly_incomes_us_dollars</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12000</span><span class="p">,</span> <span class="mi">14000</span><span class="p">,</span> <span class="mi">25000</span><span class="p">,</span> <span class="mi">28000</span><span class="p">,</span> <span class="mi">38000</span><span class="p">,</span> <span class="mi">45000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">66000</span><span class="p">,</span> <span class="mi">73000</span><span class="p">,</span> <span class="mi">75000</span><span class="p">]</span>
<span class="n">credit_card_decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;denied&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;approved&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;denied&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;approved&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">application_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">:</span> <span class="n">yearly_incomes_us_dollars</span><span class="p">,</span>
        <span class="s1">&#39;credit_card_decision&#39;</span><span class="p">:</span> <span class="n">credit_card_decisions</span>
        <span class="p">}</span>
<span class="n">df_credit_card_applications</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">application_data</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;credit_card_decision&quot;</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_22_0.png"></p>
<p>Upon looking at this graph, I think of a divide in which people that earn over $51,000 per year are more likely to be approved for this credit card. Below, I visualize my first thought with a <em>Denied Side</em> and <em>Approved Side</em> annotation. </p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;credit_card_decision&quot;</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">51000</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">bbox_props_approved</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">65000</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Approved Side&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_approved</span><span class="p">)</span>
<span class="n">bbox_props_denied</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Denied Side&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_denied</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_24_0.png"></p>
<h4>2 Features</h4>
<p>Let's gather additional data to help us build our best fit of equation to classify whether someone is approved or denied of a credit card.</p>
<p>Below, I incorporated data for people's credit score.</p>
<div class="highlight"><pre><span></span><span class="n">credit_scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">580</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">620</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">680</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">690</span><span class="p">,</span> <span class="mi">710</span><span class="p">,</span> <span class="mi">680</span><span class="p">,</span> <span class="mi">715</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">application_data</span><span class="p">[</span><span class="s2">&quot;credit_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">credit_scores</span>
<span class="n">df_credit_card_applications</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">application_data</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_credit_card_applications</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>yearly_income</th>
      <th>credit_card_decision</th>
      <th>credit_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12000</td>
      <td>denied</td>
      <td>580</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14000</td>
      <td>denied</td>
      <td>600</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25000</td>
      <td>denied</td>
      <td>620</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28000</td>
      <td>denied</td>
      <td>640</td>
    </tr>
    <tr>
      <th>4</th>
      <td>38000</td>
      <td>approved</td>
      <td>680</td>
    </tr>
    <tr>
      <th>5</th>
      <td>45000</td>
      <td>denied</td>
      <td>670</td>
    </tr>
    <tr>
      <th>6</th>
      <td>50000</td>
      <td>denied</td>
      <td>650</td>
    </tr>
    <tr>
      <th>7</th>
      <td>55000</td>
      <td>approved</td>
      <td>700</td>
    </tr>
    <tr>
      <th>8</th>
      <td>60000</td>
      <td>approved</td>
      <td>690</td>
    </tr>
    <tr>
      <th>9</th>
      <td>66000</td>
      <td>approved</td>
      <td>710</td>
    </tr>
    <tr>
      <th>10</th>
      <td>73000</td>
      <td>approved</td>
      <td>680</td>
    </tr>
    <tr>
      <th>11</th>
      <td>75000</td>
      <td>approved</td>
      <td>715</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let's visualize our two features and two class labels.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;credit_score&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Application Details&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit score&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_31_0.png"></p>
<h4>Visually Predict Which Class a New Observation Belongs To</h4>
<p>Below we see a new green plus sign to mark a new observation that doesn't have a labeled class yet. What class do you think it belongs to?</p>
<p>I would classify the new observation as being denied.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;credit_score&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">40000</span><span class="p">],</span> <span class="p">[</span><span class="mi">600</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">bbox_props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;rarrow, pad=0.6&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="s2">&quot;Predict class&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Application Details&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit score&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_34_0.png"></p>
<p>Below is another example, a purple plus sign, in which we have a new observation but no class label. What class do you think it belongs to?</p>
<p>This one is trickier. There's a decent chance/probability that this observation could be approved or denied. I would hypothesize there's a 0.60 probability that this new observation is denied.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;credit_score&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">45000</span><span class="p">],</span> <span class="p">[</span><span class="mi">660</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">bbox_props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;rarrow, pad=0.6&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">35000</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="s2">&quot;Predict class&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Application Details&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit score&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_36_0.png"></p>
<p>In my mind, I think of a dividing line that would separate the two classes. I plotted one below.</p>
<p>However, this isn't perfect. There's an observation that was approved in my denied side. I figure with additional data points, there will also be more mis-classifications like this one.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;credit_score&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">bbox_props_approved</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">65000</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="s2">&quot;Approved Side&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_approved</span><span class="p">)</span>
<span class="n">bbox_props_denied</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">28000</span><span class="p">,</span> <span class="mi">660</span><span class="p">,</span> <span class="s2">&quot;Denied Side&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_denied</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">35000</span><span class="p">,</span> <span class="mi">69000</span><span class="p">],</span> <span class="p">[</span><span class="mi">715</span><span class="p">,</span> <span class="mi">585</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Application Details&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit score&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_38_0.png"></p>
<h4>Let's Try Linear Regression for Classification</h4>
<p>Below I create a new column called <code>decision_label</code> that marks a 1 if the <code>credit_card_decision</code> is <code>approved</code> and a <code>0</code> if <code>denied</code>.</p>
<div class="highlight"><pre><span></span><span class="n">df_credit_card_applications</span><span class="p">[</span><span class="s1">&#39;decision_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_credit_card_applications</span><span class="p">[</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;approved&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>


<p>Preview the DataFrame to visually check our logic is correct.</p>
<div class="highlight"><pre><span></span><span class="n">df_credit_card_applications</span><span class="p">[[</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">,</span> <span class="s1">&#39;decision_label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>credit_card_decision</th>
      <th>decision_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>denied</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>approved</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>approved</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>denied</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>denied</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<p>We can visualize this new <code>1</code> and <code>0</code> class label name on a plot below.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_45_0.png"></p>
<p>We'll fit a linear regression model to our entire dataset. First, instantiate the <code>LinearRegression</code> object that was imported at the top of our script and assign it to the variable <code>linear_regression</code>. You can read more about the <a href='http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html' rel='nofollow'>official documentation</a> of Linear Regression on sklearn.</p>
<div class="highlight"><pre><span></span><span class="n">linear_regression</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>


<p>Let's build our linear regression line of best fit and assign it to <code>lr</code>. First, we have to get our list of x-values and y-values in the right data format for sklearn.</p>
<div class="highlight"><pre><span></span><span class="n">x_values</span> <span class="o">=</span> <span class="n">df_credit_card_applications</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">x_values</span>
</pre></div>


<div class="highlight"><pre><span></span>array([[12000],
       [14000],
       [25000],
       [28000],
       [38000],
       [45000],
       [50000],
       [55000],
       [60000],
       [66000],
       [73000],
       [75000]])
</pre></div>


<div class="highlight"><pre><span></span><span class="n">y_values</span> <span class="o">=</span> <span class="n">df_credit_card_applications</span><span class="p">[</span><span class="s1">&#39;decision_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">y_values</span>
</pre></div>


<div class="highlight"><pre><span></span>array([0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1])
</pre></div>


<div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">)</span>
</pre></div>


<p>The coefficient of our linear regression model.</p>
<div class="highlight"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>


<div class="highlight"><pre><span></span>array([1.83358404e-05])
</pre></div>


<p>The intercept of our linear regression model.</p>
<div class="highlight"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>


<div class="highlight"><pre><span></span>-0.3266408043702007
</pre></div>


<p>Our linear regression line of best fit can be modeled by the equation:</p>
<p><code>target = lr.intercept_ + yearly_income * lr.coef_</code></p>
<p>Let's plot our linear regression line of best fit using the minimum and maximum values from our x and y axes.</p>
<div class="highlight"><pre><span></span><span class="n">min_income</span> <span class="o">=</span> <span class="n">df_credit_card_applications</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">max_income</span> <span class="o">=</span> <span class="n">df_credit_card_applications</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;min_income: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_income</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;max_income: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_income</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">min_income</span><span class="o">:</span> <span class="mi">12000</span>
<span class="n">max_income</span><span class="o">:</span> <span class="mi">75000</span>
</pre></div>


<p>We can use the <code>predict</code> method to predict a credit card decision value given a yearly annual income value.</p>
<div class="highlight"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">min_income</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>array([-0.10661072])
</pre></div>


<p>Here is our linear regression line of best fit in the range of yearly income values in our dataset.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_income</span><span class="p">,</span> <span class="n">max_income</span><span class="p">],</span> <span class="p">[</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">min_income</span><span class="p">),</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">max_income</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_66_0.png"></p>
<p>Below, we calculate our R^2 when trained on the entire dataset. At <code>0.58</code>, it's reasonable, but we fail to capture a lot of the variance in our data.</p>
<div class="highlight"><pre><span></span><span class="n">r_squared</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">r_squared</span>
</pre></div>


<div class="highlight"><pre><span></span>0.5898028659646901
</pre></div>


<p>Below, I plot a decision threshold as a dotted green line that's equivalent to <code>y=0.5</code>. A <strong>decision threshold</strong> represents the result of a quantitative test to a simple binary decision. </p>
<p>For example, given an input of a yearly income value, if we get a prediction value greater than <code>0.5</code>, we'll simply round up and classify that observation as approved. </p>
<p>Let's try a yearly income of \$50,000.</p>
<div class="highlight"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>array([0.59015122])
</pre></div>


<p>Our returned result of <code>0.59</code> is greater than <code>0.5</code> so we can round up to <code>1</code> and classify this observation as being approved for a credit card.</p>
<p>Now let's try a yearly income of \$33,000.</p>
<div class="highlight"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">33000</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>array([0.27844193])
</pre></div>


<p>Our returned result of <code>0.27</code> is less than <code>0.5</code> so we can round down to <code>0</code> and classify this observation as being rejected for a credit card.</p>
<p>Below, I visualize this decision boundary.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_income</span><span class="p">,</span> <span class="n">max_income</span><span class="p">],</span> <span class="p">[</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">min_income</span><span class="p">),</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">max_income</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">orange_rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">45000</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">30000</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;navajowhite&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">orange_rect</span><span class="p">)</span>
<span class="n">blue_rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">35000</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">blue_rect</span><span class="p">)</span>
<span class="n">bbox_props_approved</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">67000</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;Always Approve&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_approved</span><span class="p">)</span>
<span class="n">bbox_props_denied</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;Always Deny&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_denied</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_75_0.png"></p>
<p>This model clearly isn't perfect. Below, I point to two observations that our model misclassifies given our linear model and rounding up/down logic.</p>
<p>More info on drawing rectangles in Matplotlib: <a href='https://matplotlib.org/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle' rel='nofollow'>patches.Rectangle documentation page</a>.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_income</span><span class="p">,</span> <span class="n">max_income</span><span class="p">],</span> <span class="p">[</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">min_income</span><span class="p">),</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">max_income</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">orange_rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">45000</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">30000</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;navajowhite&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">orange_rect</span><span class="p">)</span>
<span class="n">blue_rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">35000</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">blue_rect</span><span class="p">)</span>
<span class="n">bbox_props_approved</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">67000</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;Always Approve&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_approved</span><span class="p">)</span>
<span class="n">bbox_props_denied</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;Always Deny&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_denied</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span> <span class="c1"># removes legend</span>
<span class="n">bbox_props_left</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;larrow, pad=0.6&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">63000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Model misclassification&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_left</span><span class="p">)</span>
<span class="n">bbox_props_left</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;rarrow, pad=0.6&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Model misclassification&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_left</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_77_0.png"></p>
<div class="highlight"><pre><span></span><span class="n">df_credit_card_applications</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>yearly_income</th>
      <th>credit_card_decision</th>
      <th>credit_score</th>
      <th>decision_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12000</td>
      <td>denied</td>
      <td>580</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14000</td>
      <td>denied</td>
      <td>600</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25000</td>
      <td>denied</td>
      <td>620</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28000</td>
      <td>denied</td>
      <td>640</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>38000</td>
      <td>approved</td>
      <td>680</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let's show another reason that a linear regression isn't the best model to fit for this data. I'll now add a single outlier - an individual that applied for this credit card and has a income of \$250,000.</p>
<div class="highlight"><pre><span></span><span class="n">wealthy_person</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250000</span><span class="p">],</span>
        <span class="s1">&#39;credit_card_decision&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;approved&quot;</span><span class="p">],</span>
                  <span class="s1">&#39;credit_score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">715</span><span class="p">],</span>
                  <span class="s1">&#39;decision_label&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">}</span>
<span class="n">df_wealthy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">wealthy_person</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_cc_applications_with_outlier</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">df_wealthy</span><span class="p">])</span>
</pre></div>


<p>The steps below fit a new linear regression model to our new data that includes this outlier.</p>
<div class="highlight"><pre><span></span><span class="n">linear_regression2</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">x_values2</span> <span class="o">=</span> <span class="n">df_cc_applications_with_outlier</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_values2</span> <span class="o">=</span> <span class="n">df_cc_applications_with_outlier</span><span class="p">[</span><span class="s1">&#39;decision_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">lr2</span> <span class="o">=</span> <span class="n">linear_regression2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_values2</span><span class="p">,</span> <span class="n">y_values2</span><span class="p">)</span>
</pre></div>


<p>We assign a variable <code>max_income_outlier</code> to our new max income value of \$250,000.</p>
<div class="highlight"><pre><span></span><span class="n">max_income_outlier</span> <span class="o">=</span> <span class="n">df_cc_applications_with_outlier</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>


<p>Our visualization below plots the new linear regression line of best fit with this additional outlier point - the orange dot to the far-most right.</p>
<p>It's clear this line <strong>doesn't</strong> capture the variance in our data well. If we followed the previous decision threshold rules mentioned earlier, we'd likely misclassify more observations moving forward.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_cc_applications_with_outlier</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_income</span><span class="p">,</span> <span class="n">max_income_outlier</span><span class="p">],</span> <span class="p">[</span><span class="n">lr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">min_income</span><span class="p">),</span> <span class="n">lr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">max_income_outlier</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income with Outlier&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_87_0.png"></p>
<p>Even without this outlier, it's clear this linear regression model doesn't fit to our data well. Let's not use the data with that outlier. Let's take an earlier visualization of our linear regression line of best fit and view it on a larger x and y scale below.</p>
<p>Wow this linear regression seems off! How could someone have a credit card decision greater than <code>1</code>? That doesn't make sense since you're either approved or denied, what we marked as <code>1</code> or <code>0</code>.</p>
<div class="highlight"><pre><span></span><span class="n">zero_income</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">super_high_income</span> <span class="o">=</span> <span class="mi">200000</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;decision_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">zero_income</span><span class="p">,</span> <span class="n">super_high_income</span><span class="p">],</span> <span class="p">[</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">zero_income</span><span class="p">),</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">super_high_income</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income ($)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions Based on Yearly Income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">reformat_large_tick_values</span><span class="p">));</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_89_0.png"></p>
<h3>Logistic Regression to the Rescue!</h3>
<p>We need a better line of fit in order to classify our credit card application data. First, let's learn how the sigmoid function can be relevant.</p>
<h4>Sigmoid Function</h4>
<p>A <strong>sigmoid function</strong> is a mathematical function that represents an "s"-shaped curve. It's defined by the formula:</p>
<div class="math">$$\sigma(x)=\frac{1}{1+e^{-x}}$$</div>
<p>I'll create a list of <code>x_values</code> to plot the sigmoid function. The line of code below creates a numpy array of 120 values linearly spaced between -10 and 10. Here's the <a href='https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.linspace.html' rel='nofollow'>official documentation page</a>.</p>
<div class="highlight"><pre><span></span><span class="n">x_values_for_sigmoid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
</pre></div>


<p>Preview the first 5 values of <code>x_values</code>.</p>
<div class="highlight"><pre><span></span><span class="n">x_values_for_sigmoid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>array([-10.        ,  -9.83193277,  -9.66386555,  -9.49579832,
        -9.32773109])
</pre></div>


<p>Our sigmoid equation from above wrapped into a Python function.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</pre></div>


<p>We can see from the plot below that as <code>x</code> increase, the line approaches <code>1.0</code> but never reaches it exactly (unless you round up).</p>
<p>Similarly, as <code>x</code> decreases, the line approaches <code>0.0</code> but never reaches it exactly (unless you round down). </p>
<p>These limits of this function are exactly what we need to build our line of best fit for a binary classification. This resolves many of the problems we had with using linear regression in this situation.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values_for_sigmoid</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">x_values_for_sigmoid</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sigmoid Function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">r&#39;$\sigma(x)=\frac{1}{1+e^{-x}}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_100_0.png"></p>
<h3>Logistic Function</h3>
<p>Below is the logistic function for a single feature. The denominator looks similar to linear regression with an intercept, coefficient and error value.</p>
<div class="math">$$y_{\beta} (x) = \frac{1}{1+e^{-(\beta_0 + \beta_1 x + \epsilon)}}$$</div>
<h4>Fit Logistic Regression Model on Credit Card Data</h4>
<p>We'd expect a normal distribution with income levels. So, most incomes would be around the mean and median value. I use numpy's <code>normal</code> method from the <code>random</code> module to generate the data. See the <a href='https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.random.normal.html' rel='nofollow'>documentation here</a>.</p>
<div class="highlight"><pre><span></span><span class="n">yearly_incomes_us_dollars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">yearly_incomes_us_dollars</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">/</span><span class="nt">Users</span><span class="o">/</span><span class="nt">dan</span><span class="o">/</span><span class="nt">anaconda</span><span class="o">/</span><span class="nt">lib</span><span class="o">/</span><span class="nt">python3</span><span class="nc">.6</span><span class="o">/</span><span class="nt">site-packages</span><span class="o">/</span><span class="nt">scipy</span><span class="o">/</span><span class="nt">stats</span><span class="o">/</span><span class="nt">stats</span><span class="nc">.py</span><span class="nd">:1713</span><span class="o">:</span> <span class="nt">FutureWarning</span><span class="o">:</span> <span class="nt">Using</span> <span class="nt">a</span> <span class="nt">non-tuple</span> <span class="nt">sequence</span> <span class="nt">for</span> <span class="nt">multidimensional</span> <span class="nt">indexing</span> <span class="nt">is</span> <span class="nt">deprecated</span><span class="o">;</span> <span class="nt">use</span> <span class="err">`</span><span class="nt">arr</span><span class="cp">[</span><span class="nx">tuple</span><span class="p">(</span><span class="nx">seq</span><span class="p">)</span><span class="cp">]</span><span class="err">`</span> <span class="nt">instead</span> <span class="nt">of</span> <span class="err">`</span><span class="nt">arr</span><span class="cp">[</span><span class="nx">seq</span><span class="cp">]</span><span class="err">`</span><span class="o">.</span> <span class="nt">In</span> <span class="nt">the</span> <span class="nt">future</span> <span class="nt">this</span> <span class="nt">will</span> <span class="nt">be</span> <span class="nt">interpreted</span> <span class="nt">as</span> <span class="nt">an</span> <span class="nt">array</span> <span class="nt">index</span><span class="o">,</span> <span class="err">`</span><span class="nt">arr</span><span class="cp">[</span><span class="nx">np.array</span><span class="p">(</span><span class="nx">seq</span><span class="p">)</span><span class="cp">]</span><span class="err">`</span><span class="o">,</span> <span class="nt">which</span> <span class="nt">will</span> <span class="nt">result</span> <span class="nt">either</span> <span class="nt">in</span> <span class="nt">an</span> <span class="nt">error</span> <span class="nt">or</span> <span class="nt">a</span> <span class="nt">different</span> <span class="nt">result</span><span class="o">.</span>
  <span class="nt">return</span> <span class="nt">np</span><span class="nc">.add.reduce</span><span class="o">(</span><span class="nt">sorted</span><span class="cp">[</span><span class="nx">indexer</span><span class="cp">]</span> <span class="o">*</span> <span class="nt">weights</span><span class="o">,</span> <span class="nt">axis</span><span class="o">=</span><span class="nt">axis</span><span class="o">)</span> <span class="o">/</span> <span class="nt">sumval</span>





<span class="o">&lt;</span><span class="nt">matplotlib</span><span class="nc">.axes._subplots.AxesSubplot</span> <span class="nt">at</span> <span class="nt">0x1a15d3e278</span><span class="o">&gt;</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_106_2.png"></p>
<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">yearly_incomes_us_dollars</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>500
</pre></div>


<p>I'm going to sort <code>yearly_income_us_dollars</code> from least to greatest. </p>
<div class="highlight"><pre><span></span><span class="n">yearly_incomes_us_dollars</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">yearly_incomes_us_dollars</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">credit_card_decisions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">16</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">500</span><span class="o">-</span><span class="mi">215</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">application_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">:</span> <span class="n">yearly_incomes_us_dollars</span><span class="p">,</span>
        <span class="s1">&#39;credit_card_decision&#39;</span><span class="p">:</span> <span class="n">credit_card_decisions</span>
        <span class="p">}</span>
<span class="n">df_credit_card_applications2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">application_data</span><span class="p">)</span>
</pre></div>


<p>I want to now see the pattern between income level and credit card decision. I figure people that earn more money generally are accepted more than people who earn less money.</p>
<p>I'll use the Pandas <a href='https://pandas.pydata.org/pandas-docs/stable/generated/pandas.cut.html' rel='nofollow'>cut method</a> to bin income levels by <code>very low</code>, <code>low</code>, <code>medium</code>, <code>high</code> and <code>very high</code>.</p>
<div class="highlight"><pre><span></span><span class="n">income_bin_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_credit_card_applications2</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;very low&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;very high&quot;</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_credit_card_applications2</span><span class="p">[</span><span class="s1">&#39;income_bucket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">income_bin_labels</span>
</pre></div>


<p>There's an equal number of people in each of the five bins.</p>
<div class="highlight"><pre><span></span><span class="n">df_credit_card_applications2</span><span class="p">[</span><span class="s1">&#39;income_bucket&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>medium       245
high         156
low           71
very high     20
very low       8
Name: income_bucket, dtype: int64
</pre></div>


<p>Now that our continuous variable (income) is a categorical variable (income level), we can see the mix of the count of credit card decisions by income level. To visualize the data, I use Seaborn's <a href='https://seaborn.pydata.org/generated/seaborn.countplot.html' rel='nofollow'><code>countplot()</code> method</a>.</p>
<p>Our hypothesis was expected in that wealther individuals are more likely to get accepted for a credit card (decision value of 1) compared to less wealthy people.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;income_bucket&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Credit Card Decisions by Income Buckets&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;count [people]&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;income bucket level&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_118_0.png"></p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;credit_card_decision&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearly_income&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;swarm&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_credit_card_applications2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">8.5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=.</span><span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;credit card decision&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;yearly income [$]&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Yearly Income by Credit Card Decision&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.013</span><span class="p">);</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;matplotlib.figure.Figure at 0x1a1750e978&gt;
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_119_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df_credit_card_applications2</span><span class="p">[</span><span class="s1">&#39;yearly_income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>


<p>We need to standardize our feature <code>yearly_income</code> and can do so using <a href='http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html' rel='nofollow'>StandardScaler</a> in sklearn.</p>
<p>Why do we standardize features here? We talked about this in a previous class. Logistic regression by default uses regularization and regularization works best when we standardize our features. Otherwise, if we have outliers, we'll have issues in regularization.</p>
<p>The equation to transform each of our feature values to get a standardized feature value is below. This rescales our features to have a mean of 0 and unit variance - a variance qual to 1.</p>
<div class="math">$$x_{i} = \frac{x_{i} - \bar{x}}{\sigma}$$</div>
<p>In layman's terms, I'd describe this as: for every feature value, subtract the mean of the feature vector and divide that numerator by the standard deviation of the feature vector.</p>
<div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>StandardScaler(copy=True, with_mean=True, with_std=True)
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X_transformed</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>


<p>We can preview a histogram to see the distribution of our new feature-scaled yearly income values.</p>
<p>There's a uniform distribution with a median of roughly 0 and a mean of roughly 0.</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">X_transformed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of transformed yearly income values&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;transformed income value&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;frequency of occurence&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">/</span><span class="nt">Users</span><span class="o">/</span><span class="nt">dan</span><span class="o">/</span><span class="nt">anaconda</span><span class="o">/</span><span class="nt">lib</span><span class="o">/</span><span class="nt">python3</span><span class="nc">.6</span><span class="o">/</span><span class="nt">site-packages</span><span class="o">/</span><span class="nt">scipy</span><span class="o">/</span><span class="nt">stats</span><span class="o">/</span><span class="nt">stats</span><span class="nc">.py</span><span class="nd">:1713</span><span class="o">:</span> <span class="nt">FutureWarning</span><span class="o">:</span> <span class="nt">Using</span> <span class="nt">a</span> <span class="nt">non-tuple</span> <span class="nt">sequence</span> <span class="nt">for</span> <span class="nt">multidimensional</span> <span class="nt">indexing</span> <span class="nt">is</span> <span class="nt">deprecated</span><span class="o">;</span> <span class="nt">use</span> <span class="err">`</span><span class="nt">arr</span><span class="cp">[</span><span class="nx">tuple</span><span class="p">(</span><span class="nx">seq</span><span class="p">)</span><span class="cp">]</span><span class="err">`</span> <span class="nt">instead</span> <span class="nt">of</span> <span class="err">`</span><span class="nt">arr</span><span class="cp">[</span><span class="nx">seq</span><span class="cp">]</span><span class="err">`</span><span class="o">.</span> <span class="nt">In</span> <span class="nt">the</span> <span class="nt">future</span> <span class="nt">this</span> <span class="nt">will</span> <span class="nt">be</span> <span class="nt">interpreted</span> <span class="nt">as</span> <span class="nt">an</span> <span class="nt">array</span> <span class="nt">index</span><span class="o">,</span> <span class="err">`</span><span class="nt">arr</span><span class="cp">[</span><span class="nx">np.array</span><span class="p">(</span><span class="nx">seq</span><span class="p">)</span><span class="cp">]</span><span class="err">`</span><span class="o">,</span> <span class="nt">which</span> <span class="nt">will</span> <span class="nt">result</span> <span class="nt">either</span> <span class="nt">in</span> <span class="nt">an</span> <span class="nt">error</span> <span class="nt">or</span> <span class="nt">a</span> <span class="nt">different</span> <span class="nt">result</span><span class="o">.</span>
  <span class="nt">return</span> <span class="nt">np</span><span class="nc">.add.reduce</span><span class="o">(</span><span class="nt">sorted</span><span class="cp">[</span><span class="nx">indexer</span><span class="cp">]</span> <span class="o">*</span> <span class="nt">weights</span><span class="o">,</span> <span class="nt">axis</span><span class="o">=</span><span class="nt">axis</span><span class="o">)</span> <span class="o">/</span> <span class="nt">sumval</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_126_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df_credit_card_applications2</span><span class="p">[</span><span class="s1">&#39;credit_card_decision&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>


<p>We will use the Logistic Regression module built into sklearn. Remember to always read the default parameters since this implementation uses regularization. Here is the <a href='http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html' rel='nofollow'>documentation page</a>.</p>
<div class="highlight"><pre><span></span><span class="n">log_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
</pre></div>


<p>Let's do a train-test-split and use 65% of observations for training our model and the other 35% for testing how our model performs on unseen data. The official documentation page for train-test-split is <a href='http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html' rel='nofollow'>here on sklearn</a>.</p>
<div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_transformed</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>


<p>Let's fit our training data to our Logistic Regression object.</p>
<div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class=&#39;ovr&#39;, n_jobs=1,
          penalty=&#39;l2&#39;, random_state=None, solver=&#39;liblinear&#39;, tol=0.0001,
          verbose=0, warm_start=False)
</pre></div>


<h4>Visualize Results of Logistic Regression Model Predictions</h4>
<p>Our model is fitted. We can now visualize our line of best fit on our training data.</p>
<p>Later, we'll cover model evaluation metrics.</p>
<p>Our <code>log_reg</code> object has a <code>predict_proba()</code> method. So, if we pass in an x-value (after our feature scaling transformation), we're outputted the probability that observations belongs to class 0 (denied) and class 1 (approved).</p>
<p>In the example below, the first item in that list is the probability that this observation belongs to class 0, and the second list item is the probability this this observation belongs to class 1.</p>
<div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>array([0.71828833, 0.28171167])
</pre></div>


<p>I want to create a single array of <em>just</em> the probabilities that our model predicts in which each of the observations from our training data belongs to class 1.</p>
<div class="highlight"><pre><span></span><span class="n">X_train_probability_class_1</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X_train_probability_class_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>0.2817116677754508
</pre></div>


<p>To plot the data, I'm going to put our <code>X_train</code> observations and <code>X_train_probability_class_1</code> predictions as two columns.</p>
<div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x_train_points&quot;</span><span class="p">:</span> <span class="n">X_train</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                 <span class="s2">&quot;x_train_probability_being_class_1&quot;</span><span class="p">:</span> <span class="n">X_train_probability_class_1</span><span class="p">}</span>
<span class="n">df_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</pre></div>


<p>Hey look! It's our plotted predictions and it looks like a sigmoid function!</p>
<div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_predictions</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x_train_points&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;x_train_probability_being_class_1&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blueviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predictions on Training Data&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income feature scaled&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;probability of a prediction being class 1 (approved)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_143_0.png"></p>
<p>So if our logistic regression model outputs a probability between 0 and 1 of an observation belonging to class 1, then how do we classify if the observation belongs to class 0 or class 1? </p>
<p>As we talked about earlier, you have a <strong>decision threshold</strong>. In binary classification problems in sklearn, there is a default probability decision threshold of 0.5. So, if for an observation we predict a 0.6 probability it belongs to class 1, since 0.6 is greater than 0.5, we'll round up and classify that observation as belonging to class 1.</p>
<div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_predictions</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x_train_points&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;x_train_probability_being_class_1&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blueviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predictions on Training Data&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income feature scaled&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;probability of a prediction being class 1 (accepted)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">bbox_props_decision_threshold</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="s2">&quot;Decision Threshold&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_decision_threshold</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">);</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_145_0.png"></p>
<p>Below, I shaded the areas in which if we predict a new observation lies in that area, we'll classify the observation as belonging either to class 0 or class 1.</p>
<div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_predictions</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x_train_points&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;x_train_probability_being_class_1&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blueviolet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predictions on Training Data&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income feature scaled&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;probability of a prediction being class 1 (accepted)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">bbox_props_decision_threshold</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;snow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.60</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="s2">&quot;Decision Threshold&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_decision_threshold</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">);</span>

<span class="n">orange_rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mf">3.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;navajowhite&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">orange_rect</span><span class="p">)</span>
<span class="n">bbox_props_approved</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;Round up to 1&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_approved</span><span class="p">)</span>

<span class="n">blue_rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">2.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">blue_rect</span><span class="p">)</span>
<span class="n">bbox_props_denied</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;Round down to 0&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox_props_denied</span><span class="p">);</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_147_0.png"></p>
<p>As a hypothetical scenario, we work for this bank, and let's say all of a sudden many people who we give credit cards out to are not paying off their bills in time and so now the bank is low in cash. We don't know the exact underlying reason why this is happening all of a sudden. One hypothesis could be that we've been too lenient about giving out credit cards to people who are on the fence of deserving them. </p>
<p>We can utilize this knowledge to modify our predictions. Notice how above the probability decision threshold is at 0.5. If we wanted to be pickier about selecting high-quality appilcants for credit cards, we could move our decision threshold up to a value such as 0.7. Then, for our simple example, we'd only approve applicants with a higher income score.</p>
<h4>Visualize Predictions - Writing our Logistic Regression Prediction Function</h4>
<p>Below is the logistic function for a single feature again. </p>
<div class="math">$$y_{\beta} (x) = \frac{1}{1+e^{-(\beta_0 + \beta_1 x + \epsilon)}}$$</div>
<p>Let's look at our coefficient.</p>
<div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>


<div class="highlight"><pre><span></span>array([[5.76770022]])
</pre></div>


<p>Let's look at our intercept.</p>
<div class="highlight"><pre><span></span><span class="n">log_reg</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>


<div class="highlight"><pre><span></span>array([1.1217481])
</pre></div>


<p>We can use the intercept and coefficient from our logistic regression model and simply plug it into the logistic function to visualize our predictions (same as what's above).</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_reg_model_credit_card_applications_predict</span><span class="p">(</span><span class="n">yearly_income</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">log_reg</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">+</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">coef_</span> <span class="o">*</span> <span class="n">yearly_income</span><span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">log_reg_model_credit_card_applications_predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blueviolet&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Predictions on Training Data&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.015</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;yearly income feature scaled&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;probability of a prediction being class 1 (accepted)&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_158_0.png"></p>
<h3>Classification Evaluation Metrics</h3>
<h4>Accuracy</h4>
<p><strong>Accuracy</strong> is the proportion of correct predictions. You could also multiply the proportion by 100 to report a percentage value.</p>
<p>Let's view a simplified example of our predictions on an unseen dataset and calculcate accuracy.</p>
<table>
<thead>
<tr>
<th>Person id</th>
<th>Annual Income in U.S. dollars</th>
<th>Model's prediction of credit card decision</th>
<th>Actual credit card decision</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>30000</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>45000</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>48000</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>55000</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>80000</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>There were 5 total observations. For 4/5 observations, our model predicted a label equivalent to the actual label. 4/5 is 0.8. So we can say the accuracy score of this model is <code>0.8</code>. </p>
<p>In sklearn, for our logistic regression object, which we assigned to <code>log_reg</code>, we can use the <code>score</code> method and pass in our test data to return an accuracy score.</p>
<p>Typically you report on the accuracy of your model against the test set as a measure for the model's performance.</p>
<div class="highlight"><pre><span></span><span class="n">accuracy_test_set</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">accuracy_test_set</span>
</pre></div>


<div class="highlight"><pre><span></span>0.9714285714285714
</pre></div>


<p>I want to round this value to two decimal places. See this <a href='https://stackoverflow.com/questions/455612/limiting-floats-to-two-decimal-points' rel='nofollow'>Stack Overflow article</a> for the method. </p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;{0:.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">accuracy_test_set</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span>0.97
</pre></div>


<p>There is one major caveat of using accuracy as an evaluation metric of your predictive algorithm. Let's illustrate this caveat through an example. Let's say we're a doctor and we're trying to diagnose people that may have a deadly disease. For most people that come into our office, they <em>aren't</em> diagnosed with the disease. </p>
<p>Below is a sample of the data.</p>
<table>
<thead>
<tr>
<th>Person id</th>
<th>Age</th>
<th>Family history of disease</th>
<th>Model's disease prediction</th>
<th>Actual diagnosis of disease</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>38</td>
<td>"yes"</td>
<td>"no"</td>
<td>"yes"</td>
</tr>
<tr>
<td>2</td>
<td>42</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>3</td>
<td>58</td>
<td>"yes"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>4</td>
<td>39</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>5</td>
<td>55</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>6</td>
<td>61</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>7</td>
<td>52</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>8</td>
<td>45</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>9</td>
<td>59</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>10</td>
<td>48</td>
<td>"no"</td>
<td>"no"</td>
<td>"no"</td>
</tr>
</tbody>
</table>
<p>We could build a model with close to 1.0 accuracy by <em>always</em> predicting someone doesn't have the disease. But what happens when someone ends up having the disease? If we say they don't, we won't give them the proper care they need to treat the disease. </p>
<p>This is an example of <strong>imbalanced classes</strong> - since there's more observations of one class than another. You can learn more about how to fix evaluation of models with imbalanced classes through this article on <a href='https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/' rel='nofollow'>Machine Learning Mastery</a>. We won't go into detail on the topic in this tutorial.</p>
<h4>Confusion Matrix</h4>
<p>Below we'll pre-process our data to build a confusion matrix. A <strong>confusion matrix</strong> is a table that describes the performance of a classification model on a set of test data for which the actual labels are known. Let's begin...</p>
<p>Our <code>X_test</code> values are meant to utilized to evaluate how our model performs on these unseen inputs. We use our model to make predictions/classify the observations given <code>X_test</code>. We assign our list of class predictions to the variable <code>y_test_predictions</code>.</p>
<div class="highlight"><pre><span></span><span class="n">y_test_predictions</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>


<p>As expected, we see a list of 1s and 0s.</p>
<div class="highlight"><pre><span></span><span class="n">y_test_predictions</span>
</pre></div>


<div class="highlight"><pre><span></span>array([1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1,
       1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0,
       0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0,
       1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0,
       0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0,
       1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0,
       1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0])
</pre></div>


<p>We can use <a href='https://docs.python.org/3/library/collections.html#collections.Counter' rel='nofollow'><code>Counter</code></a> to create a dictionary of how many predictions are of class 1 versus of class 0.</p>
<div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">(</span><span class="n">y_test_predictions</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Counter({1: 94, 0: 81})
</pre></div>


<div class="highlight"><pre><span></span><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;denied&quot;</span><span class="p">,</span> <span class="s2">&quot;approved&quot;</span><span class="p">]</span>
</pre></div>


<p>Let's plot our confusion matrix and below we'll explain each element of it. The function below was originally modified from this sklearn <a href='http://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html#sphx-glr-auto-examples-model-selection-plot-confusion-matrix-py' rel='nofollow'>documentation page</a>. </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Confusion matrix&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function prints and plots the confusion matrix.</span>
<span class="sd">    Normalization can be applied by setting `normalize=True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>

    <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>    
    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="c1"># i and j tell us the coordinates of boxes</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;True Negatives&quot;</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;False Positives&quot;</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;True Positives&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;False Negatives&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">format</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span> <span class="k">if</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh</span> <span class="k">else</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True label&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Compute confusion matrix</span>
<span class="n">cnf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_predictions</span><span class="p">);</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>

<span class="c1"># Plot non-normalized confusion matrix</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cnf_matrix</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Confusion matrix, without normalization&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="visual_introduction_classification_logistic_regression_files/visual_introduction_classification_logistic_regression_176_0.png"></p>
<p>Our first insights, ignoring the text in the boxes:</p>
<ul>
<li>There are two class labels: <em>approved</em> and <em>denied</em>.</li>
<li>The x-axis is labeled <em>Predicted label</em> - meaning our model's predictions given <code>X_test</code>. </li>
<li>The y-axis is labeled <em>True label</em> - meaning the class labels for our <code>X_test</code> observations.</li>
<li>The model made a total of 175 predictions (equivalent to 75+3+4+93) on if those 175 individuals should be approved or denied of a credit card.</li>
<li>Out of the 175 predictions, 79 (equivalent to 4 + 75) were for the <em>denied</em> class.</li>
<li>Out of the 175 predictions, 96 (equivalent to 93 + 3) were for the <em>approved</em> class.</li>
</ul>
<p>Let's explain each of the numbers in the boxes:</p>
<ul>
<li>For 75 observations (from <code>X_test</code>) the model predicted <em>denied</em> and the label was actually <em>denied</em>.</li>
<li>For 4 observations (from <code>X_test</code>) the model predicted <em>denied</em> but the label was actually <em>approved</em>.</li>
<li>For 3 observations (from <code>X_test</code>) the model predicted <em>approved</em> but the label was actually <em>denied</em>.</li>
<li>For 93 observations (from <code>X_test</code>) the model predicted <em>approved</em> and it was actually <em>approved</em>.</li>
</ul>
<p>The exact names of True Negatives, False Positives, False Negatives and True Positives will come in handy for other significant evaluation metrics of classification models.</p>
<h4>Precision</h4>
<p><strong>Precision</strong>: for our predictions of the positive class (<em>approved</em> in our example), how often is it correct?</p>
<p>The equation is:</p>
<p>Precision = True Positives / (True Positives + False Positives)</p>
<p>We can manually calculcate precision given the values in the confusion matrix above.</p>
<p>Precision = 93 / (93+3) = 0.96875</p>
<p>In sklearn, we can use the <a href='http://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_score.html' rel='nofollow'><code>precision_score</code> method</a> from the <code>metrics</code> module.</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Precision: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_predictions</span><span class="p">)))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Precision</span><span class="o">:</span> <span class="mf">0.9893617021276596</span>
</pre></div>


<h4>Recall</h4>
<p><strong>Recall</strong>: when the actual label is positive (<em>approved</em> in our example), how often did we predict correctly?</p>
<p>The equation is:</p>
<p>Recall = True Positives / (True Positives + False Negatives)</p>
<p>We can manually calculate recall given the values in the confusion matrix above.</p>
<p>Recall = 93 / (93 + 4) = 0.96</p>
<p>In sklearn, we can use the <a href='http://scikit-learn.org/stable/modules/generated/sklearn.metrics.recall_score.html' rel='nofollow'><code>recall</code> method</a> from the <code>metrics</code> module.</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Recall:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_predictions</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Recall</span><span class="o">:</span> <span class="mf">0.96</span>
</pre></div>


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "left",
        indent = "1em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div>
</section>

  </div>
  
  <!-- start of footer section -->
  <footer class="footer">
    <div class="container">
      <p class="text-muted">
        <center>Thank you for reading my content! This project is available on <a href="https://github.com/frieds/frieds.github.io">GitHub</a>.
          <br/>
          Copyright &copy; Dan Friedman,
          <time datetime="2019">2019</time>.
        </center>
      </p>
    </div>
  </footer>

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
  crossorigin="anonymous"></script>

  <!-- This jQuery line finds any span that contains code highlighting classes and then selects the parent <pre> tag and adds a border and background. This is done as a workaround to visually distinguish the code inputs and outputs -->
  <script>
    $( ".hll, .n, .c, .err, .k, .o, .cm, .cp, .c1, .cs, .gd, .ge, .gr, .gh, .gi, .go, .gp, .gs, .gu, .gt, .kc, .kd, .kn, .kp, .kr, .kt, .m, .s, .na, .nb, .nc, .no, .nd, .ni, .ne, .nf, .nl, .nn, .nt, .nv, .ow, .w, .mf, .mh, .mi, .mo, .sb, .sc, .sd, .s2, .se, .sh, .si, .sx, .sr, .s1, .ss, .bp, .vc, .vg, .vi, .il" ).parent( "pre" ).css( "border", "1px solid #038f6d" );
    $( ".hll, .n, .c, .err, .k, .o, .cm, .cp, .c1, .cs, .gd, .ge, .gr, .gh, .gi, .go, .gp, .gs, .gu, .gt, .kc, .kd, .kn, .kp, .kr, .kt, .m, .s, .na, .nb, .nc, .no, .nd, .ni, .ne, .nf, .nl, .nn, .nt, .nv, .ow, .w, .mf, .mh, .mi, .mo, .sb, .sc, .sd, .s2, .se, .sh, .si, .sx, .sr, .s1, .ss, .bp, .vc, .vg, .vi, .il" ).parent( "pre" ).css( "background-color", "#d6eed9" );
  </script>

  <!-- Latest compiled and minified Bootstrap JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <script src="https://dfrieds.com/theme/js/ie10-viewport-bug-workaround.js"></script>
  <!-- <script type="text/javascript">
    $(document).on('click', 'a[href^="#"]', function (event) {
      event.preventDefault();
      $('html, body').animate({
        scrollTop: $($.attr(this, 'href')).offset().top
      }, 500);
    });
  </script> -->

</body>

</html>